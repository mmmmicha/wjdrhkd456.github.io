---
title: "Project Log. 4"
date: 2020-07-21 23:30:40 -0400
categories: project log DBMS Functions
---

정부사업을 진행하면서 기록하는 네 번째 로그이다.
<br><br>
다른얘기. 정처기 실기가 어느 덧 3일이 남은 상태로, 코앞으로 다가왔다.
<br>
정처기를 공부하면서 지식들을 습득한다는 느낌보다는 기존에 애매하게 알고있었던 지식들을 다듬고 정리하는 느낌을 많이 받고 있다. 단박에 끝내버리고 빨리 내가 하고싶은 공부들에 집중하고 싶다.
<br><br>
오늘은 DB의 성능개선에 대해 값진 경험을 했다.
<br><br>
그 경험은 바로.. select 문에 **사용자 정의 함수** 의 사용이 미치는 엄청난 악영향이었다.
<br><br>
내가 현재 담당하고 있는 기능중 HISTORY(이력) 을 조회하는 부분이 있다.(대부분의 **이력** 테이블들은 방대한 데이터량을 가지고 있음)
<br>
이를 조회하는 쿼리를 구성하는데 **사용자 정의 함수** 가 한 개 쓰이고 있다. 이 함수의 역할은 매우 단순하다. POST 테이블에서 POST_CD 를 받아 그에 맞는 POST_NM 을 내준다.
<br>
완성된 쿼리를 DBMS에게 수행시켰을 때 조회시간은 무려.. 22sec 나 되었다.(눈을 의심치 않아도 된다. 사실이다.)
<br>
이를 JOIN 으로 대체한 후 똑같은 기능을 수행하도록 조회를 실시했을 땐 0.5sec 로 단축된 것을 확인했다. 
<br><br>
**사용자 정의 함수** 의 가장 큰 단점은 함수가 불릴 때마다 그 함수 내 사용되고 있는 **테이블** 이 계속 로딩된다는 것이다.
<br>
22만개의 데이터를 조회해야 하는 경우, JOIN을 한 경우엔 `기존 테이블 + JOIN 테이블` 딱 1개를 초반에 로딩하면 되지만, 함수를 부르는 경우엔 무려 22만 1개를 수행내내 로딩해야 한다.
<br>
이로 인해 발생하는 손실은 절대 무시할 수 없다.
<br><br>
평상시 사용자 정의 함수를 잘 사용하지 않았기에 몰랐는데, 다른 사람이 작성한 쿼리를 작업하면서 이런 좋은 경험을 할 수 있어서 뜻깊었다. 회사 출근하자마자 이런 비슷한 류로 코딩이 되어있는 쿼리들은
싹 다 고쳐야겠다.
<br><br>
이상 정처기때문에 시간에 쫓기며 쓰는 포스팅 끝.
